<div class="text-sm breadcrumbs">
  <ul>
    <li><%= link_to t('home'), root_path %></li>
  </ul>
</div>

<div class="flex flex-row justify-between">
  <div tabindex="0" class="collapse bg-primary text-primary-content focus:bg-secondary focus:text-secondary-content flex-1">
    <div class="collapse-title">
      <div><%= t('order.qrcode') %></div>
    </div>
    <div class="collapse-content"> 
      <canvas data-controller="qrcode" data-text="<%= @url_string %>"></canvas>
    </div>
  </div>

  <div tabindex="0" class="collapse bg-primary text-primary-content focus:bg-secondary focus:text-secondary-content flex-1 ml-4">
    <div class="collapse-title">
      <div><%= t('order.google map') %></div>
    </div>
    <div class="collapse-content"> 
      <iframe
        width="710"
        height="300"
        frameborder="0" style="border:0"
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key=<%= ENV['GOOGLE_API_KEY'] %>&q=<%= ERB::Util.url_encode(address(@shop)) %>"
        allowfullscreen>
      </iframe>
    </div>
  </div>
</div>

<div class="grid grid-cols-2 gap-4 mt-8">
  <div>
    <div class="card w-full bg-white-100 shadow-xl">
      <div class="card-body gap-4">
        <div class="card-title"><%= t('order.booking info') %></div>
        <div class="flex justify-between">
          <span><%= @order.product.title %><%= @order.service_min %><%= t('order.min') %></span>
          <span><%= t('order.currency') %> <%= @order.price.to_i %></span>
        </div>
        <table class="table text-center">
          <thead>
            <tr class="border-2 border-gray-500">
              <th><%= t('order.booking date') %></th>
              <th><%= t('order.booking start time') %></th>
              <th><%= t('order.booking end time') %></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><%= format_date(@order.service_date) %></td>
              <td><%= format_time_without_sec(@order.service_date) %></td>
              <td><%= booking_end_time(@order) %></td>
            </tr>
          </tbody>
        </table>
        <div class="flex justify-between border-2  border-gray-500 p-4">
          <span>總計：</span>
          <span><%= t('order.currency') %> <%= @order.price.to_i %></span>
        </div>        
      </div>
    </div>
    <div class="card w-full bg-white-100 shadow-xl">
      <div class="card-body gap-4">
        <div class="card-title"><%= t('order.contact info') %></div>
        <div class="flex">
          <%= tag.label t('order.name'), class: 'label' %>
          <%= tag.label @order.booked_name, class: 'label' %>
        </div>
        <div class="flex">
          <%= tag.label 'Email', class: 'label' %>
          <%= tag.label @order.booked_email, class: 'label' %>
        </div>
      </div>
    </div>
  </div>
  <div>
    <div class="card w-full bg-white-100 shadow-xl">
      <% if @order.shop.cover.attached? %>
        <figure><%= image_tag @order.shop.cover, class: "w-full h-[300px]" %></figure>
      <% else %>
        <figure><img src="https://fakeimg.pl/1000x300/200" class="w-full h-[300px]"></figure>
      <% end %>
      <div class="card-body gap-4">
        <div class="card-title">
            <p><%= @order.shop.title %></p>
            <span><%= @order.product.title %><%= @order.service_min %><%= t('order.min') %></span>
        </div>
      </div>
    </div>
  </div>
</div>
